
create database flighttest;
use flighttest
CREATE TABLE admin (
	admin_id INT IDENTITY(1,1) primary key ,
	username VARCHAR(50) not null,
	password VARCHAR(50) not null,
);

CREATE TABLE users (
	id INT PRIMARY KEY IDENTITY(1,1),
	name VARCHAR(50) NOT NULL,
	password VARCHAR(55) NOT NULL,
	email VARCHAR(50) NOT NULL UNIQUE,
	full_name NVARCHAR(50) NOT NULL,
	phone VARCHAR(20) NOT NULL
);

CREATE TABLE airports(
  id INT PRIMARY KEY IDENTITY(1,1), 
  airport_code VARCHAR(10) NOT NULL,
  airport_name VARCHAR(50) NOT NULL,
  location VARCHAR(100) NOT NULL
);

CREATE TABLE routes (
  id INT PRIMARY KEY IDENTITY (1,1),
  airport_id INT,
  departure_airport VARCHAR(35) NOT NULL,
  arrival_airport VARCHAR(35) NOT NULL,
  
  FOREIGN KEY(airport_id) REFERENCES airports(id)
);

CREATE TABLE flights (
  id INT PRIMARY KEY IDENTITY(1,1), 
  route_id INT NOT NULL,
  flight_number VARCHAR(10) NOT NULL,
  flight_name VARCHAR(20) NOT NULL,
  total_seat INT,  
  departure_time DATETIME NOT NULL,
  arrival_time DATETIME NOT NULL,
  FOREIGN KEY(route_id) REFERENCES routes(id)
);

CREATE TABLE bookings (
  id INT PRIMARY KEY IDENTITY(1,1),
  user_id INT, 
  full_name NVARCHAR(100) NOT NULL, 
  email VARCHAR(100), 
  phone VARCHAR(20),
  gender VARCHAR(10) NOT NULL,
  accommodation VARCHAR(255) NOT NULL,
  booked_seats INT NOT NULL,  
  total_amount DECIMAL(10,2) NOT NULL,
  flight_id INT NOT NULL,
  FOREIGN KEY(user_id) REFERENCES users(id), 
  FOREIGN KEY(flight_id) REFERENCES flights(id)
);

CREATE TABLE payments (
  id INT PRIMARY KEY IDENTITY(1,1),
  booking_id INT NOT NULL,
  payment_method VARCHAR(30),
  transaction_id VARCHAR(20),
  transaction_time DATETIME,
  FOREIGN KEY (booking_id) REFERENCES bookings(id)
);

CREATE TABLE seats (
  id INT PRIMARY KEY IDENTITY(1,1),
  flight_id INT NOT NULL,
  seat_number VARCHAR(10) NOT NULL,
  is_booked BIT NOT NULL DEFAULT 0,
  FOREIGN KEY (flight_id) REFERENCES flights(id)
);